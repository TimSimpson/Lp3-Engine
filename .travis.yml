language: cpp

clang-linux: &clang-linux
  os: linux
  dist: bionic
  python: "3.7"
  compiler: clang
  addons:
    apt:
      sources:
        - ubuntu-toolchain-r-test
        - llvm-toolchain-bionic-8
      packages:
        - clang-8
        - libstdc++-8-dev
        - python3-pip
        - xorg-dev

emscripten: &emscripten
  os: linux
  dist: bionic
  python: "3.7"
  compiler: clang
  addons:
    apt:
      packages:
        - python3-pip

osx: &osx
   os: osx
   language: generic
   osx_image: xcode11.3

install:
  - git clone https://github.com/TimSimpson/ci-land.git ci
  - pushd ci && git checkout abf52caf7ca4d23cc3d016b1448ae25c0f4a1fdc && popd
  - ./ci/cpp/conan/travis/install.sh

script:
  - ./ci/cpp/conan/travis/run.sh

matrix:
  include:

    - name: "Linux Clang 8.0 Release"
      <<: *clang-linux
      env:
        - PROFILE=clang-8-r-static
    - name: "Linux Clang 8.0 Debug"
      <<: *clang-linux
      env:
        - PROFILE=clang-8-d-static
    - name: "Emscripten WASM Release"
      <<: *clang-linux
      env:
        - PROFILE=emscripten-w-r
    - name: "Emscripten Javascript Debug"
      <<: *clang-linux
      env:
        - PROFILE=emscripten-js-d

    - name: "Docs"
      language: python
      os: linux
      dist: bionic
      python: "3.7"
      addons:
        apt:
          packages:
            - python3-pip
            - pandoc
      script:
        - ./ci/cpp/conan/travis/docs.sh

env:
  global:
    - CONAN_LOGIN_USERNAME=TimSimpson
    - secure: "BU+n8/DhUa+V0XJc+q0z5Yoeut+t+eesc1XcLQ4LrWmcGfGnRQKmY5JTHQAfm9SX+DjUDPpqe02JPXf4LMlGhdK51Igvm/5+AyJsSNN/oMOmJSw9fWAo9O264Oce4IuWZszPxHdj4UZ89zMVa6l3RSzPSq0hsxfwjS32PzydtNJTaF6SjGRrv4MRqSD44i8DV6Knyf72TPw1nCZXr2P9tfbuoMYnmitpdxtKOnIOozp7pUm15Lsj+h9w1xYTGY5XH3e66OGyeOLRoT6BRFKKGxPE2YhVa8wqLZAuJLpYgpc36UyXnLEevroMZRUtkGgpHxULdZlpdqmZBL95XwDs4waO3L42YPavxXUSzKCsLbw73SdLyusEN19phTRwzq0Vw1xx5Iqxf0mfpZ3ijH7wQ+c/VJtfDHeUltp2vjEq1IDYvxgFymEe7NfjrKPII41vG3fuGdiW+WnpiO1TLJseydZdJC5huzJofjW9AZvLmLyetq3vfHOni0kV18dHkYKZQGo17y2miXcTChJu6IlnYZyDUKX3D2uqttpUzPK6Rl28UIZI+j/wbybNZXRlJu3qGMaQZzdXWH9i1pAxkG2unPARQQBtC2Wbk8pg+9VzHzAik8bSEe9Dp51+Jm9TTIaLSHlkq/4CYm0uG5jY9n8kQKnWKt17Q7oNrSAFsyIBXYA="
